dsl_version: 0.5.0
service:
  name: designate-worker
  ports:
    - cont: 5358
  containers:
    - name: designate-worker
      image: designate-worker
      pre:
        - name: designate-pool-update
          files:
            - pools
            - designate-conf
          type: single
          command: designate-manage pool update --file /etc/designate/pools.yaml
      daemon:
        dependencies:
          - designate-api
        files:
          - designate-conf
          - rndc-conf
          - rndc-key
        command: designate-worker --config-file /etc/designate/designate.conf

files:
  designate-conf:
    path: /etc/designate/designate.conf
    content: designate.conf.j2
  pools:
    path: /etc/designate/pools.yaml
    content: pools.yaml.j2
  named-conf:
    path: /etc/bind/named.conf.options
    content: named.conf.options.j2
  rndc-conf:
    path: /etc/bind/rndc.conf
    content: rndc.conf.j2
  rndc-key:
    path: /etc/bind/rndc.key
    content: rndc.key.j2
